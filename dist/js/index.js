var songList,controlManger,$=window.Zepto,root=window.player,$scope=$(document.body),index=0,audio=new root.audioControl;function bindEvent(){$scope.on("play:change",function(o,t,n){audio.getAudio(songList[t].audio),("play"==audio.status||n)&&(audio.play(),root.pro.start()),root.pro.renderAllTime(songList[t].duration),root.render(songList[t])}),$scope.on("click",".like-btn",function(){$(this).toggleClass("liking")}),$scope.on("click",".prev-btn",function(){var o=controlManger.prev();$scope.trigger("play:change",o),"pause"==audio.status?(audio.pause(),root.pro.update(0)):(audio.play(),root.pro.start())}),$scope.on("click",".next-btn",function(){var o=controlManger.next();$scope.trigger("play:change",o),"pause"==audio.status?(audio.pause(),root.pro.update(0)):(root.pro.start(),audio.play())}),$scope.on("click",".play-btn",function(){"play"==audio.status?($scope.find(".img-wrapper").removeClass("rotate"),audio.pause(),root.pro.stop()):($scope.find(".img-wrapper").addClass("rotate"),audio.play(),root.pro.start()),$(this).toggleClass("pause")})}function bindTouch(){var o=$scope.find(".slider-pointer"),t=$scope.find(".pro-bottom").offset(),a=t.left,e=t.width;o.on("touchstart",function(){root.pro.stop()}).on("touchmove",function(o){var t=(o.changedTouches[0].clientX-a)/e;0<t&&t<=1&&(root.pro.update(t),$scope.find(".img-wrapper").removeClass("rotate"))}).on("touchend",function(o){var t=(o.changedTouches[0].clientX-a)/e;if(0<t&&t<=1){var n=t*songList[controlManger.index].duration;audio.playTo(n),$scope.find(".play-btn").addClass("pause"),$scope.find(".img-wrapper").addClass("rotate"),root.pro.start(t)}})}function getData(o){$.ajax({type:"GET",url:o,success:function(o){root.render(o[0]),songList=o,bindEvent(),bindTouch(),controlManger=new root.controlManger(o.length),$scope.trigger("play:change",0)},error:function(){}})}getData("../mock/data.json");